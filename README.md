# JS_2.4.3 - Homework Project

Этот проект содержит функцию `calculateBonus`, которая вычисляет бонус на основе суммы двух чисел с ограничением максимального бонуса в 50 единиц.

## Описание проекта

Проект включает в себя:

- Функцию `calculateBonus(a, b)` для расчета бонуса
- Комплексные тесты с использованием Jest
- Настроенную среду разработки с автоматическим тестированием

### Логика работы функции

Функция `calculateBonus` принимает два параметра `a` и `b`, суммирует их и:

- Если сумма больше 50, возвращает 50
- Если сумма меньше или равна 50, возвращает саму сумму

## Установка

### Предварительные требования

- Node.js (версия 14 или выше)
- npm (обычно устанавливается вместе с Node.js)
- Git

### Шаги установки

1. **Клонирование репозитория:**

   ```bash
   git clone https://github.com/Natalia-Zher/JS_2.4.3.git
   cd JS_2.4.3
   ```

2. **Установка зависимостей:**
   ```bash
   npm install
   ```

## Настройка

Проект уже настроен и готов к использованию. Основные файлы конфигурации:

- `package.json` - содержит метаданные проекта и скрипты
- `sum.js` - основной файл с функцией `calculateBonus`
- `sum.test.js` - файл с тестами

## Запуск проекта

### Запуск основного кода

Для выполнения основного файла с примером использования:

```bash
node sum.js
```

### Запуск в режиме разработки

Вы можете изменить файл `sum.js` и запускать его для тестирования различных значений:

```javascript
// Раскомментируйте строку в sum.js для вывода результата
console.log(calculateBonus(5, 5)); // Выведет: 10
```

## Тестирование

Проект использует Jest для тестирования. Тесты покрывают различные сценарии использования функции.

### Запуск тестов

```bash
npm test
```

### Запуск тестов в режиме наблюдения

```bash
npm test -- --watch
```

**Остановка режима наблюдения:**

- Нажмите `q` - выход из режима наблюдения
- Нажмите `Ctrl + C` (на Mac: `Cmd + C`) - принудительная остановка

**Полезные команды в режиме watch:**

- `q` - выйти из режима наблюдения
- `a` - запустить все тесты
- `f` - запустить только неуспешные тесты
- `p` - фильтровать тесты по имени файла
- `t` - фильтровать тесты по имени теста

### Запуск тестов с покрытием кода

```bash
npm test -- --coverage
```

## Измерение покрытия кода

### Что мы измеряем

В нашем проекте мы отслеживаем качество тестирования через анализ покрытия кода. Jest автоматически анализирует, какие части кода выполняются во время тестов.

### Типы покрытия

Jest измеряет четыре основных типа покрытия:

#### 1. **Покрытие строк (Lines Coverage)**

- **Что измеряет:** Процент строк кода, которые были выполнены во время тестов
- **Пример:** Если в функции 10 строк, и тесты выполнили 8 из них, покрытие строк = 80%
- **Важно:** Самый базовый показатель, показывает общий объем протестированного кода

#### 2. **Покрытие функций (Functions Coverage)**

- **Что измеряет:** Процент функций, которые были вызваны хотя бы один раз
- **Пример:** Если в файле 5 функций, и тесты вызвали 4 из них, покрытие функций = 80%
- **Важно:** Показывает, все ли функции вообще тестируются

#### 3. **Покрытие веток (Branches Coverage)**

- **Что измеряет:** Процент условных переходов (if/else, switch, тернарные операторы), которые были протестированы
- **Пример:** В коде `sum > 50 ? (bonus = 50) : (bonus = sum)` есть 2 ветки:
  - Ветка 1: когда `sum > 50` (возвращает 50)
  - Ветка 2: когда `sum <= 50` (возвращает sum)
- **Важно:** Самый критичный показатель! Гарантирует тестирование всех логических путей

#### 4. **Покрытие утверждений (Statements Coverage)**

- **Что измеряет:** Процент отдельных утверждений (statements), которые были выполнены
- **Важно:** Похоже на покрытие строк, но более детально

### Настройка покрытия в Jest

#### Базовый запуск с покрытием

```bash
npm test -- --coverage
```

#### Запуск с детальным отчетом

```bash
npm test -- --coverage --verbose
```

#### Настройка порогов покрытия

Можно добавить в `package.json` настройки минимальных порогов:

```json
{
  "jest": {
    "coverageThreshold": {
      "global": {
        "branches": 80,
        "functions": 80,
        "lines": 80,
        "statements": 80
      }
    },
    "collectCoverageFrom": ["*.js", "!node_modules/**"]
  }
}
```

### Интерпретация результатов покрытия

После запуска `npm test -- --coverage` вы увидите таблицу вроде:

```
File      | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s
----------|---------|----------|---------|---------|-------------------
sum.js    |     100 |      100 |     100 |     100 |
----------|---------|----------|---------|---------|-------------------
All files |     100 |      100 |     100 |     100 |
```

#### Расшифровка:

- **% Stmts** - покрытие утверждений
- **% Branch** - покрытие веток (самое важное!)
- **% Funcs** - покрытие функций
- **% Lines** - покрытие строк
- **Uncovered Line #s** - номера непокрытых строк

### Цели покрытия в нашем проекте

Для функции `calculateBonus` мы стремимся к:

- ✅ **100% покрытие веток** - тестируем оба случая: `sum > 50` и `sum <= 50`
- ✅ **100% покрытие функций** - функция `calculateBonus` вызывается в тестах
- ✅ **100% покрытие строк** - все строки функции выполняются
- ✅ **Граничные случаи** - тестируем значения около 50 (49.9, 50, 50.1)

### HTML отчет покрытия

Для более детального анализа автоматически создается HTML отчет, который можно открыть в браузере:

```bash
npm test -- --coverage
```

**Просмотр отчета:**

1. HTML отчет автоматически создается в папке `coverage/lcov-report/`
2. Откройте файл `coverage/lcov-report/index.html` в браузере
3. В отчете вы увидите:
   - Интерактивную навигацию по файлам
   - Подсветку покрытых/непокрытых строк
   - Детальную статистику по каждому файлу
   - Визуальное представление веток и условий

**Быстрый способ открыть в браузере:**

```bash
# На Mac
open coverage/lcov-report/index.html

# На Windows
start coverage/lcov-report/index.html

# На Linux
xdg-open coverage/lcov-report/index.html
```

### Что тестируется

Тесты покрывают следующие случаи:

1. **Сумма меньше 50** - функция возвращает саму сумму
2. **Сумма равна 50** - функция возвращает 50
3. **Сумма больше 50** - функция возвращает 50 (максимальный бонус)
4. **Нулевые значения** - корректная обработка нулей
5. **Отрицательные числа** - работа с отрицательными значениями
6. **Десятичные числа** - поддержка чисел с плавающей точкой
7. **Граничные случаи** - тестирование значений около 50

### Примеры тестовых случаев

```javascript
calculateBonus(10, 15); // Ожидается: 25
calculateBonus(25, 25); // Ожидается: 50
calculateBonus(30, 30); // Ожидается: 50
calculateBonus(-10, 30); // Ожидается: 20
calculateBonus(10.5, 15.3); // Ожидается: 25.8
```

## Структура проекта

```
JS_2.4.3/
├── package.json          # Метаданные проекта и зависимости
├── package-lock.json     # Точные версии установленных пакетов
├── sum.js               # Основной файл с функцией calculateBonus
├── sum.test.js          # Тесты для функции calculateBonus
└── README.md            # Документация проекта
```

## Скрипты

В `package.json` настроены следующие скрипты:

- `npm test` - запуск тестов Jest

## Автор

**N Zher**

## Лицензия

ISC

## Репозиторий

[https://github.com/Natalia-Zher/JS_2.4.3](https://github.com/Natalia-Zher/JS_2.4.3)

## Устранение неполадок

### Проблемы с установкой

Если при установке возникают ошибки:

1. Убедитесь, что у вас установлена актуальная версия Node.js
2. Очистите кэш npm: `npm cache clean --force`
3. Удалите `node_modules` и переустановите: `rm -rf node_modules && npm install`

### Проблемы с тестами

Если тесты не запускаются:

1. Убедитесь, что Jest установлен: `npm list jest`
2. Проверьте, что в `package.json` есть скрипт test
3. Запустите тесты с подробным выводом: `npm test -- --verbose`
